syntax = "proto3";

option go_package = "github.com/alphasoc/protos/detection";

package detection;

service DetectionProc {
  rpc Process (DetectionData) returns (ProcessedReply) {}
}

message DetectionData {
  repeated Detection dets = 1;
  repeated Expiration exps = 2;
}

message Node {
  string addr = 1;
}

message Expiration {
  Node node = 1;
}

message Threat {
  string threat_list_name = 1;
  repeated string threat_names = 2;
}

message Detection {
  string type = 1;
  string title = 2;
  enum Severity {
    NONE = 0;
    LOW = 1;
    MEDIUM = 2;
    HIGH = 3;
  }
  Severity sev = 3;
  string action_type = 4;
  string service_name = 5;
  Node node = 6;
  repeated Threat threats = 7;
}

message ProcessedReply {
  bool rc = 1;
}